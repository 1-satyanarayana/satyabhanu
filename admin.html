<!DOCTYPE html>
<html>
  <head>
    <title>Admin Panel ‚Äì AWS Exam</title>
    <style>
      /* ===== GENERAL STYLING ===== */
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea, #764ba2);
        min-height: 100vh;
        margin: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        color: #333;
      }

      h2 {
        color: #fff;
        margin-bottom: 20px;
        text-align: center;
        font-size: 28px;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
      }

      /* ===== LOGIN BOX ===== */
      #loginBox {
        background: #fff;
        padding: 30px 40px;
        border-radius: 12px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        display: flex;
        flex-direction: column;
        width: 320px;
        margin-bottom: 30px;
      }

      #loginBox input {
        padding: 12px 15px;
        margin: 10px 0;
        border-radius: 8px;
        border: 1px solid #ccc;
        outline: none;
        font-size: 16px;
        transition: 0.3s;
      }

      #loginBox input:focus {
        border-color: #667eea;
        box-shadow: 0 0 8px rgba(102, 126, 234, 0.5);
      }

      #loginBox button {
        margin-top: 15px;
        padding: 12px;
        background: #667eea;
        border: none;
        border-radius: 8px;
        color: #fff;
        font-size: 18px;
        cursor: pointer;
        transition: 0.3s;
      }

      #loginBox button:hover {
        background: #5a67d8;
        transform: translateY(-2px);
      }

      /* ===== ADMIN PANEL ===== */
      #adminPanel {
        background: #fff;
        padding: 30px 40px;
        border-radius: 12px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        width: 95%;
        max-width: 1000px;
      }

      #adminPanel button {
        margin: 5px 5px 15px 0;
        padding: 10px 18px;
        background: #2b7cff;
        border: none;
        border-radius: 6px;
        color: #fff;
        font-size: 15px;
        cursor: pointer;
        transition: 0.3s;
      }

      #adminPanel button:hover {
        background: #1a5ecc;
        transform: translateY(-2px);
      }

      /* ===== TABLE STYLING ===== */
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
      }

      th,
      td {
        padding: 12px;
        text-align: center;
        border-bottom: 1px solid #ddd;
      }

      th {
        background: #2b7cff;
        color: #fff;
        font-weight: 600;
      }

      tr:nth-child(even) {
        background: #f9f9f9;
      }

      tr:hover {
        background: #e0ebff;
        transition: 0.3s;
      }

      /* ===== RESPONSIVE DESIGN ===== */
      @media (max-width: 768px) {
        #loginBox,
        #adminPanel {
          width: 90%;
          padding: 20px;
        }

        #adminPanel button {
          width: 100%;
          margin-bottom: 10px;
        }

        table {
          font-size: 14px;
        }
      }
    </style>
  </head>
  <body>
    <h2>üîê Admin Login</h2>
    <div id="loginBox">
      <input id="adminUser" placeholder="Username" /><br />
      <input id="adminPass" type="password" placeholder="Password" /><br />
      <button onclick="adminLogin()">Login</button>
    </div>

    <div id="adminPanel" style="display: none">
      <h2>üìä AWS Exam ‚Äì Results</h2>
      <button onclick="loadResults()">üîÑ Refresh</button>
      <button onclick="downloadResults()">üíæ Download All</button>
      <button onclick="clearResults()">üóë Clear All</button>

      <!--<h3>Add Question</h3>
      <input id="qText" placeholder="Question" /><br />
      <input id="opt1" placeholder="Option 1" /><br />
      <input id="opt2" placeholder="Option 2" /><br />
      <input id="opt3" placeholder="Option 3" /><br />
      <input id="opt4" placeholder="Option 4" /><br />
      <input id="correctOpt" placeholder="Correct Option (0-3)" /><br />
      <button onclick="addQuestion()">‚ûï Add Question</button>-->

      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>Roll</th>
            <th>Phone</th>
            <th>Score</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody id="data"></tbody>
      </table>
    </div>

    <script>
      const ADMIN_USER = "SatyaBhanu";
      const ADMIN_PASS = "SatyaBhanu";

      function adminLogin() {
        if (
          document.getElementById("adminUser").value === ADMIN_USER &&
          document.getElementById("adminPass").value === ADMIN_PASS
        ) {
          document.getElementById("loginBox").style.display = "none";
          document.getElementById("adminPanel").style.display = "block";
          loadResults();
        } else alert("Invalid Login");
      }

      // ===== LOAD RESULTS =====
      function loadResults() {
        fetch(
          "https://script.google.com/macros/s/AKfycbwK2azAwS-_4zxRXbR1--6lJLR5iT8341QvWfJDJFsOV-s--7K-eoDZ5PqkZHyWf-x7/exec"
        )
          .then((r) => r.json())
          .then((d) => {
            const tbody = document.getElementById("data");
            tbody.innerHTML = "";
            d.forEach((r, i) => {
              tbody.innerHTML += `<tr>
          <td>${i + 1}</td><td>${r[0]}</td><td>${r[1]}</td>
          <td>${r[2]}</td><td>${r[3]}</td><td>${r[4]}</td>
        </tr>`;
            });
          });
      }

      // ===== DOWNLOAD RESULTS =====
      function downloadResults() {
        fetch(
          "https://script.google.com/macros/s/AKfycbwK2azAwS-_4zxRXbR1--6lJLR5iT8341QvWfJDJFsOV-s--7K-eoDZ5PqkZHyWf-x7/exec?action=download"
        )
          .then((r) => r.json())
          .then((data) => {
            let csv = data
              .map((row) => row.map((cell) => `"${cell}"`).join(","))
              .join("\n");
            let blob = new Blob([csv], { type: "text/csv" });
            let url = URL.createObjectURL(blob);
            let a = document.createElement("a");
            a.href = url;
            a.download = "PythonExamResults.csv";
            a.click();
            URL.revokeObjectURL(url);
          });
      }

      // ===== CLEAR RESULTS =====
      function clearResults() {
        if (!confirm("Are you sure?")) return;
        fetch(
          "https://script.google.com/macros/s/AKfycbwK2azAwS-_4zxRXbR1--6lJLR5iT8341QvWfJDJFsOV-s--7K-eoDZ5PqkZHyWf-x7/exec?action=clear"
        )
          .then((r) => r.text())
          .then(() => {
            alert("All results cleared!");
            loadResults();
          });
      }

      // ===== ADD QUESTION =====
      function addQuestion() {
        const q = document.getElementById("qText").value;
        const o1 = document.getElementById("opt1").value;
        const o2 = document.getElementById("opt2").value;
        const o3 = document.getElementById("opt3").value;
        const o4 = document.getElementById("opt4").value;
        const a = document.getElementById("correctOpt").value;

        fetch(
          `https://script.google.com/macros/s/AKfycbwK2azAwS-_4zxRXbR1--6lJLR5iT8341QvWfJDJFsOV-s--7K-eoDZ5PqkZHyWf-x7/exec?action=addQuestion&q=${encodeURIComponent(
            q
          )}&o1=${encodeURIComponent(o1)}&o2=${encodeURIComponent(
            o2
          )}&o3=${encodeURIComponent(o3)}&o4=${encodeURIComponent(o4)}&a=${a}`
        )
          .then((r) => r.text())
          .then((res) => {
            alert("Question added!");
            document.getElementById("qText").value = "";
            document.getElementById("opt1").value = "";
            document.getElementById("opt2").value = "";
            document.getElementById("opt3").value = "";
            document.getElementById("opt4").value = "";
            document.getElementById("correctOpt").value = "";
          })
          .catch(() => alert("Failed to add question"));
      }
    </script>
  </body>
</html>
